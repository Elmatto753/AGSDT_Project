#ifndef THREAD_H_
#define THREAD_H_

#include <QThread>
#include <QThreadPool>
#include <QMutexLocker>
#include <QTimer>

#include "ImpactObject.h"

//----------------------------------------------------------------------------------------------------------------------
/// @file ObjectUpdateThread.h
/// @brief Thread for handling the updating of the impact object, subclasses QThread
/// @author Matt Skellon
/// @version 1.0
/// @date 04/05/17
/// @class ObjectUpdateThread
/// Revision History :
/// Initial version
//----------------------------------------------------------------------------------------------------------------------

class ObjectUpdateThread : public QThread
{
  Q_OBJECT
public:

  ObjectUpdateThread();
  ~ObjectUpdateThread();

  //----------------------------------------------------------------------------------------------------------------------
    /// @brief Overwritten run function from QThread
  //----------------------------------------------------------------------------------------------------------------------
  void run();
  //----------------------------------------------------------------------------------------------------------------------
    /// @brief Loads the impact object's mesh
  //----------------------------------------------------------------------------------------------------------------------
  void setUp();
  //----------------------------------------------------------------------------------------------------------------------
    /// @brief Setter for the object's direction
    /// @param _dir New direction
  //----------------------------------------------------------------------------------------------------------------------
  void setImpactObjectDirection(ngl::Vec3 _dir);
  //----------------------------------------------------------------------------------------------------------------------
    /// @brief Setter for the object's velocity
    /// @param _vel New velocity
  //----------------------------------------------------------------------------------------------------------------------
  void setImpactObjectVelocity(float _vel);
  //----------------------------------------------------------------------------------------------------------------------
    /// @brief Setter for the object's mass
    /// @param _mass New mass
  //----------------------------------------------------------------------------------------------------------------------
  void setImpactObjectMass(float _mass);
  //----------------------------------------------------------------------------------------------------------------------
    /// @brief Setter for the object's radius
    /// @param _rad New Radius
  //----------------------------------------------------------------------------------------------------------------------
  void setImpactObjectRadius(float _rad);
  //----------------------------------------------------------------------------------------------------------------------
    /// @brief Setter for the object's position
    /// @param _pos New position
  //----------------------------------------------------------------------------------------------------------------------
  void setImpactObjectPosition(ngl::Vec3 _pos);
  //----------------------------------------------------------------------------------------------------------------------
    /// @brief Getter for an the impact object
  //----------------------------------------------------------------------------------------------------------------------
  ImpactObject getImpactObject() { return m_impact; }
  //----------------------------------------------------------------------------------------------------------------------
    /// @brief Getter for a mutex for the thread
  //----------------------------------------------------------------------------------------------------------------------
  QMutex *getMutex() { return &m_mutex; }

public slots:
  //----------------------------------------------------------------------------------------------------------------------
    /// @brief Slot to update objects
  //----------------------------------------------------------------------------------------------------------------------
  void updateObjects();

protected:
  //----------------------------------------------------------------------------------------------------------------------
    /// @brief The impact object
  //----------------------------------------------------------------------------------------------------------------------
  ImpactObject m_impact;
  //----------------------------------------------------------------------------------------------------------------------
    /// @brief A mutex to lock thread data
  //----------------------------------------------------------------------------------------------------------------------
  QMutex m_mutex;
  //----------------------------------------------------------------------------------------------------------------------
    /// @brief A timer to set the rate at which objects update
  //----------------------------------------------------------------------------------------------------------------------
  QTimer *m_timer;

};


#endif
